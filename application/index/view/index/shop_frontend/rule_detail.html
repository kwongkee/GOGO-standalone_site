{include file="layouts/shop_header"}
{include file="layouts/header2"}

<!--<link href="/css/font-awesome.css" rel="stylesheet">-->
<link rel="stylesheet" href="layui/css/layui.css?v=23121"/>
<!--<link rel="stylesheet" href="/assets/d2eace91/js/layer/theme/default/layer.css?v=3.1.0" id="layuicss-layer">-->
<script type="text/javascript" src="layui/layui.js"></script>
<script src="js/jquery.js?v=1.1"></script>

<style type="text/css" media="all">
    body{background:{$data['websites']['info']['color_inner']} !important;}
    .fa{font-family:FontAwesome !important;}
    .fa-location-arrow{color:#ffffff !important;}
    #content{padding-top:120px;padding-bottom:40px;}
    .content{box-sizing:border-box;margin-top: 20px;}
    .content .col-md-12{padding:0;float:unset;}
    .content .box_content{justify-content:center;border-radius:8px;margin-bottom:30px;}
    .content .box_content{background:{$data['websites']['info']['color']};color:{$data['websites']['info']['color_word']};border:1px solid {$data['websites']['info']['color_word']};font-size:25px;text-align:center;padding:30px;width:100%;}
    .content .box_content img{width:40px;margin-right:5px;}
    .inquiry_box{display:none;}
    .navbar_menu{color: {$data['websites']['info']['color_word']};font-size: 16px;margin-bottom:10px;}
    .context,.navbar_menu a{color:{$data['websites']['info']['color']};}
    .context{margin-bottom:1cm;}
    .layui-colla-title{color:{$data['websites']['info']['color_word']};background-color:{$data['websites']['info']['color']};}
    .preamble_con,.layui-colla-content{color:{$data['websites']['info']['color_word']};font-size:15px;}
    .layui-colla-content p{margin-bottom:0.3cm;}

    footer{display: block !important;}
    /*.xm-select-demo .xm-label{overflow: hidden;}*/
    /*.xm-select-demo .xm-label-block{white-space: nowrap;}*/
</style>

<section id="content common_inner_background" class="non_topimg">
    <div class="w1200">
        <div class="container">
            <div class="content" >
                <div class="layui-fluid" style="padding:0;">
                    <div class="layui-row layui-col-space15">
                        <div class="layui-col-md12" style="padding:0;">
                            <p class="navbar_menu"><i class="fa fa-sign-in" style="margin-right:5px;display:none;"></i><a href="/">HOME</a>&nbsp;<span style="color:{$data['websites']['info']['color']};">\</span>&nbsp;<a href="/rule_list" style="color:{$data['websites']['info']['color']};">平台规则</a>&nbsp;<span style="color:{$data['websites']['info']['color']};">\</span>&nbsp;<a href="/version_list?pid={$rule['id']}" style="color:{$data['websites']['info']['color']};">{$rule['rule_name']}</a>&nbsp;<span style="color:{$data['websites']['info']['color']};">\</span>&nbsp;<span style="color:{$data['websites']['info']['color']};">{$rule['version']}</span></p>
                            <div class="row" style="width:100%;margin:0 auto 20px auto;">
                                <div class="col-md-12">
                                    <div class="common_inner_background" style="border:1px solid {$data['websites']['info']['color']};height: 650px;overflow-y: scroll;padding:0 10px;box-sizing:border-box;">
                                        <!--序言头部-->
                                        {if $rule['is_preamble']==1 && $rule['position_display']==1}
                                            <div class="preamble_con" style="margin-top:0.5cm;">{$rule['preamble_con']}</div>
                                        {/if}
                                        {if $rule['type']==1}
                                        <div class="layui-collapse" lay-accordion="now" style="margin:10px 0;">
                                            {foreach name="rule['content2']" key="key" id="vo"}
                                            <div class="layui-colla-item">
                                                <h2 class="layui-colla-title">{$vo['parag_num']}&nbsp;{$vo['title']}</h2>
                                                <div class="layui-colla-content @if($key==1)
                                                                layui-show
@endif">
                                                    <p>{$vo['content']}</p>
                                                    {if !empty($vo['children'])}
                                                    {foreach name="vo['children']" key="key2" id="vo2"}
                                                    <div class="layui-collapse" lay-accordion="now" onclick="hide_sib(this)">
                                                        <div class="layui-colla-item">
                                                            <h2 class="layui-colla-title">{$vo2['parag_num']}&nbsp;{$vo2['title']}</h2>
                                                            <div class="layui-colla-content">
                                                                <p>{$vo2['content']}</p>
                                                                {if !empty($vo2['children'])}
                                                                {foreach name="vo2['children']" key="key3" id="vo3"}
                                                                <div class="layui-collapse" lay-accordion="now" lay-filter="now" onclick="hide_sib(this)">
                                                                    <div class="layui-colla-item">
                                                                        <h2 class="layui-colla-title" data-parag_num="{$vo3['parag_num']}">{$vo3['parag_num']}&nbsp;{$vo3['title']}</h2>
                                                                        <div class="layui-colla-content">
                                                                            <p>{$vo3['content']}</p>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                {/foreach}
                                                                {/if}
                                                            </div>
                                                        </div>
                                                    </div>
                                                    {/foreach}
                                                    {/if}
                                                </div>
                                            </div>
                                            {/foreach}
                                        </div>
                                        {else}
                                        <div style="padding-top:1cm;">
                                            {foreach name="rule['content']" key="k" id="vo"}
                                            <div class="context">{$vo}</div>
                                            {/foreach}
                                        </div>
                                        {/if}
                                        <!--序言底部-->
                                        {if $rule['is_preamble']==1 && $rule['position_display']==2}
                                        <div class="preamble_con" style="margin-bottom:0.5cm;">{$rule['preamble_con']}</div>
                                        {/if}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--是否有配置跳转其他应用-->
            {if isset($footerInfo['have_link'])}
            <style>
                .box_content {display: flex;align-items: center;justify-content: space-evenly;margin-top:12px;}
                .need_service, .need_share, .need_advice {padding: 7px 10px;box-sizing: border-box;font-size: 15px;font-weight: 800;box-shadow: 1px 1px 10px #333;text-align: center;margin: 15px 0;border: 1px solid #D2A778;color: #fff;background: #1f5188;white-space: nowrap;}
                @media (min-width: 1000px) {
                    .need_service, .need_share, .need_advice {padding: 15px 75px;}
                }
            </style>
            <div class="box_content">
                {if !empty($footerInfo['link'])}
                <a href="{$footerInfo['link']}" target="_blank">
                    <div class="need_service">
                        <i class="fa fa-location-arrow" style="color:{$data['websites']['info']['color_word']};font-size:15px;margin-right:3px;"></i>
                        我要服务
                    </div>
                </a>
                {/if}

                <a href="https://mp.weixin.qq.com/mp/profile_ext?action=home&amp;__biz=MzA4MDQyMTMxMQ==&amp;scene=110#wechat_redirect" target="_blank">
                    <div class="need_share">
                        <img loading="lazy" alt="GOGO198 網站圖片" src="https://www.gogo198.net/img/wechat.png" alt="" style="width:20px;">
                        关注公号
                    </div>
                </a>
            </div>
            {/if}
        </div>
    </div>
</section>

{include file="layouts/footer"}
<script>
    layui.use(['layer', 'form', 'table', 'upload','element'], function () {
        var $ = layui.$
            , layer = layui.layer
            , form = layui.form
            , element = layui.element
            , upload = layui.upload
            , table = layui.table;

        form.render(null, 'component-form-element');

        //渲染
        {if $rule['type']==1}
        //记录点击值,已有则不重复请求
        var history_click = '';
        //监听折叠
        element.on('collapse(now)', function(data){
            // console.log(history_click.indexOf(data.title[0].dataset.parag_num));
            if(history_click.indexOf(data.title[0].dataset.parag_num)==-1){
                history_click += data.title[0].dataset.parag_num+',';
                let t = $(this);
                $.ajax({
                    type: "POST",
                    dataType:"json",
                    url: "/?s=merch/rule_detail&company_id={$company_id}&company_type={$company_type}", //ajax请求地址
                    data:{'id':"{$rule['id']}",'parag_num':data.title[0].dataset.parag_num},
                    success: function (data) {
                        if(data.data.length>0){
                            let html = '';
                            for(let i=0;i<data.data.length;i++){
                                html += '<div class="layui-collapse" lay-accordion="now" onclick="hide_sib(this)">'+
                                    '<div class="layui-colla-item">'+
                                    '<h2 class="layui-colla-title" data-parag_num="'+data.data[i].parag_num+'">'+data.data[i].parag_num+'&nbsp;'+data.data[i].title+'</h2>'+
                                    '<div class="layui-colla-content">'+
                                    '<p>'+data.data[i].content+'</p>';
                                if(data.data.children != ''){
                                    for(let i2=0;i2<data.data[i].children.length;i2++){
                                        html += '<div class="layui-collapse" lay-accordion="now" onclick="hide_sib(this)">'+
                                            '<div class="layui-colla-item">'+
                                            '<h2 class="layui-colla-title" data-parag_num="'+data.data[i].children[i2].parag_num+'">'+data.data[i].children[i2].parag_num+'&nbsp;'+data.data[i].children[i2].title+'</h2>'+
                                            '<div class="layui-colla-content">'+
                                            '<p>'+data.data[i].children[i2].content+'</p>';
                                        if(data.data[i].children[i2].children != ''){
                                            for(let i3=0;i3<data.data[i].children[i2].children.length;i3++){
                                                html += '<div class="layui-collapse" lay-accordion="now" lay-filter="now" onclick="hide_sib(this)">'+
                                                    '<div class="layui-colla-item">'+
                                                    '<h2 class="layui-colla-title" data-parag_num="'+data.data[i].children[i2].children[i3].parag_num+'">'+data.data[i].children[i2].children[i3].parag_num+'&nbsp;'+data.data[i].children[i2].children[i3].title+'</h2>'+
                                                    '<div class="layui-colla-content">'+
                                                    '<p>'+data.data[i].children[i2].children[i3].content+'</p>';
                                                html+='</div>'+
                                                    '</div>'+
                                                    '</div>';
                                            }
                                        }
                                        html+='</div>'+
                                            '</div>'+
                                            '</div>';
                                    }
                                }
                                html+='</div>'+
                                    '</div>'+
                                    '</div>';
                            }
                            $(t).parent().find('.layui-colla-content').append(html);
                            form.render(null,'component-form-element');
                            element.render('collapse');
                        }
                    },
                });
            }
        });
        element.render('collapse');
    {/if}
    });

    function hide_sib(t){
        var $ = layui.$
            , layer = layui.layer
            , element = layui.element;
        for(let i=0;i<$(t).siblings().length;i++){
            $(t).siblings().eq(i).find('.layui-show').removeClass('layui-show');
        }

        element.render('collapse');
    }
</script>